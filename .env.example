# ═══════════════════════════════════════════════════════════════════════════════
# MUNIFY Delegator - Environment Configuration
# ═══════════════════════════════════════════════════════════════════════════════
# Copy this file to .env and replace the values with your own.
# Variables marked [REQUIRED] must be set for the application to start.
# Variables marked [OPTIONAL] have sensible defaults or enable optional features.
# ═══════════════════════════════════════════════════════════════════════════════

# ───────────────────────────────────────────────────────────────────────────────
# CORE APPLICATION
# ───────────────────────────────────────────────────────────────────────────────

# [REQUIRED] Session encryption secret - use a strong random string
# Generate with: openssl rand -hex 32
SECRET=your-secret-key-here

# [REQUIRED] Application environment
# Values: development | production | test
NODE_ENV=development

# [OPTIONAL] Server port (default: 3000)
PORT=3000

# ───────────────────────────────────────────────────────────────────────────────
# DATABASE
# ───────────────────────────────────────────────────────────────────────────────

# [REQUIRED] PostgreSQL connection string
# Format: postgres://USER:PASSWORD@HOST:PORT/DATABASE
DATABASE_URL=postgres://postgres:postgres@localhost:5432/postgres

# ───────────────────────────────────────────────────────────────────────────────
# AUTHENTICATION (OIDC)
# ───────────────────────────────────────────────────────────────────────────────
# Supports any OpenID Connect provider (tested with ZITADEL)

# [REQUIRED] OIDC Discovery URL (usually ends with /.well-known/openid-configuration)
# Local mock: http://localhost:8080/default/.well-known/openid-configuration
# Production: https://your-oidc-provider.com
PUBLIC_OIDC_AUTHORITY=http://localhost:8080/default/.well-known/openid-configuration

# [REQUIRED] OAuth2 Client ID from your OIDC provider
PUBLIC_OIDC_CLIENT_ID=default

# [OPTIONAL] OAuth2 Client Secret (only needed for confidential clients)
# OIDC_CLIENT_SECRET=your-client-secret

# [REQUIRED] OAuth2 scopes to request
# Must include "openid" and "offline_access" at minimum
OIDC_SCOPES="openid profile offline_access address email family_name gender given_name locale name phone preferred_username urn:zitadel:iam:org:projects:roles urn:zitadel:iam:user:metadata urn:zitadel:iam:org:project:id:zitadel:aud"

# [OPTIONAL] JWT claim path for user roles (ZITADEL-specific format shown)
# Used to determine team member permissions
OIDC_ROLE_CLAIM=urn:zitadel:iam:org:project:275671427955294244:roles

# ───────────────────────────────────────────────────────────────────────────────
# APPLICATION FEATURES
# ───────────────────────────────────────────────────────────────────────────────

# [OPTIONAL] Default locale for the application (default: de)
# Values: de | en
# PUBLIC_DEFAULT_LOCALE=de

# [OPTIONAL] Enable global user notes visible to team members (default: false)
PUBLIC_GLOBAL_USER_NOTES_ACTIVE=true

# [OPTIONAL] Maximum character length for application motivation text (default: 1200)
PUBLIC_MAX_APPLICATION_TEXT_LENGTH=1200

# [OPTIONAL] Maximum character length for school name field (default: 100)
# PUBLIC_MAX_APPLICATION_SCHOOL_LENGTH=100

# [OPTIONAL] URL to external feedback/bug reporting tool
PUBLIC_FEEDBACK_URL=https://fb-delegator.dmun.de

# [OPTIONAL] Support email address displayed on error pages (default: support@dmun.de)
# PUBLIC_SUPPORT_EMAIL=support@dmun.de

# [OPTIONAL] Organization domain for team invitations
# When set, shows a warning when inviting emails from other domains
# PUBLIC_TEAM_ORGANIZATION_DOMAIN=dmun.de

# ───────────────────────────────────────────────────────────────────────────────
# CERTIFICATES
# ───────────────────────────────────────────────────────────────────────────────

# [REQUIRED] Secret key for signing participation certificates (HMAC-SHA256)
# Generate with: openssl rand -base64 32
CERTIFICATE_SECRET="your-certificate-secret-here"

# ───────────────────────────────────────────────────────────────────────────────
# MAINTENANCE WINDOWS
# ───────────────────────────────────────────────────────────────────────────────
# Display a maintenance banner to users during scheduled maintenance

# [OPTIONAL] Maintenance window start time (ISO 8601 format with timezone)
# PUBLIC_MAINTENANCE_WINDOW_START=2025-10-22T00:00:00Z

# [OPTIONAL] Maintenance window end time (ISO 8601 format with timezone)
# PUBLIC_MAINTENANCE_WINDOW_END=2025-10-22T04:00:00Z

# ───────────────────────────────────────────────────────────────────────────────
# EMAIL (SMTP)
# ───────────────────────────────────────────────────────────────────────────────
# Transactional email for notifications (e.g., paper review notifications)
# For local development, use Mailpit: localhost:1025 (SMTP), localhost:8025 (Web UI)

# [OPTIONAL] SMTP server hostname (default: localhost)
SMTP_HOST=localhost

# [OPTIONAL] SMTP server port (default: 1025)
SMTP_PORT=1025

# [OPTIONAL] Use TLS/SSL connection (default: false)
# Set to "true" for production SMTP servers that require encryption
SMTP_SECURE=false

# [OPTIONAL] SMTP authentication username
SMTP_USER=

# [OPTIONAL] SMTP authentication password
SMTP_PASSWORD=

# [OPTIONAL] Sender email address (default: noreply@munify.cloud)
SMTP_FROM_ADDRESS=noreply@munify.cloud

# [OPTIONAL] Sender display name (default: MUNIFY Delegator)
SMTP_FROM_NAME=MUNIFY Delegator

# ───────────────────────────────────────────────────────────────────────────────
# OBSERVABILITY (OpenTelemetry)
# ───────────────────────────────────────────────────────────────────────────────
# Distributed tracing for performance monitoring

# [OPTIONAL] OpenTelemetry collector endpoint URL
# OTEL_ENDPOINT_URL=http://localhost:4318/v1/traces

# [OPTIONAL] Service name for traces (default: MUNIFY-DELEGATOR)
# OTEL_SERVICE_NAME=MUNIFY-DELEGATOR

# [OPTIONAL] Service version for traces
# OTEL_SERVICE_VERSION=1.0.0

# [OPTIONAL] Authorization header for authenticated OTEL collectors
# OTEL_AUTHORIZATION_HEADER=Bearer your-token

# ───────────────────────────────────────────────────────────────────────────────
# ERROR TRACKING (Sentry/Bugsink)
# ───────────────────────────────────────────────────────────────────────────────
# Error monitoring and crash reporting
# For local development, use Bugsink: http://localhost:8000

# [OPTIONAL] Sentry/Bugsink DSN for server-side error tracking
# SENTRY_DSN=http://your-key@localhost:8000/1

# [OPTIONAL] Sentry/Bugsink DSN for client-side error tracking
# PUBLIC_SENTRY_DSN=http://your-key@localhost:8000/1

# [OPTIONAL] Include PII (user IPs, etc.) in error reports (default: false)
# SENTRY_SEND_DEFAULT_PII=false
# PUBLIC_SENTRY_SEND_DEFAULT_PII=false

# ───────────────────────────────────────────────────────────────────────────────
# EXTERNAL INTEGRATIONS
# ───────────────────────────────────────────────────────────────────────────────

# --- Badge Generator ---
# [OPTIONAL] URL to external badge/name tag generator service
# When set, adds a "Generate Badge" button in participant management
# PUBLIC_BADGE_GENERATOR_URL=https://badges.example.com

# --- Listmonk (Newsletter) ---
# [OPTIONAL] Listmonk API URL for newsletter subscription management
# LISTMONK_API_URL=http://localhost:9000/api

# [OPTIONAL] Listmonk API username
# LISTMONK_API_USER=api

# [OPTIONAL] Listmonk API key
# LISTMONK_API_KEY=your-api-key

# --- Slack Notifications ---
# [OPTIONAL] Slack webhook URL for general notifications
# SLACK_NOTIFICATION_WEBHOOK=https://hooks.slack.com/services/...

# [OPTIONAL] Slack webhook URL for error alerts
# SLACK_ERROR_WEBHOOK=https://hooks.slack.com/services/...

# ───────────────────────────────────────────────────────────────────────────────
# BUILD-TIME VARIABLES (set automatically during CI/CD)
# ───────────────────────────────────────────────────────────────────────────────
# These are typically set by CI/CD and should not be manually configured

# [AUTO] Application version
# PUBLIC_VERSION=1.0.0

# [AUTO] Git commit SHA
# PUBLIC_SHA=abc123
